<script th:inline="javascript">
/*<![CDATA[*/
var specIndex = [[${specIndex}]];
var robotInfos = /*[[${robotInfos}]]*/ [];
var codeOfFirstRobot = 'defaultCode'; // 기본 코드 설정
if (robotInfos.length > 0) {
  codeOfFirstRobot = robotInfos[specIndex].code; // 0번 인덱스의 코드로 설정
}

let selectedDeck = specIndex;
let editor;

require.config({ paths: { 'vs': 'https://unpkg.com/monaco-editor@latest/min/vs' } });
require(["vs/editor/editor.main"], function () {
    editor = monaco.editor.create(document.getElementById('container-body'), {
      value: codeOfFirstRobot,
      language: 'java',
      theme: 'vs-dark',
      automaticLayout: true,
      fontSize: 20,
      minimap: {

        enabled: false,
    },
        wordWrap: "on"
    });
});

// play battle
// playBattle(specIndex);

function getEditorValue() {
    if (editor) {
        const content = editor.getValue();// Display the content, you can do whatever you want with it
        return content;
    }
}

function code_check(result, status, index, code) {
    const terminal = document.getElementById('terminal');

    if (result != 0) {
        terminal.innerHTML = `<span class="terminal-error">${status}: ${result}</span>`;
    } else {
        terminal.innerHTML = `<span class="terminal-success">${status}: ${result}</span>`;
    robotInfos[index] = code;
    }
}


function selectDeckIndex(deckId) {
    selectedDeck = deckId;
    if(robotInfos[selectedDeck]){
        editor.setValue(robotInfos[selectedDeck].code)
        console.log(selectedDeck);
    } else {
        console.log('No robot info found for selected deck.')
    }
}

function run_code() {
    change_code(selectedDeck, getEditorValue());
}

/*]]>*/

</script>